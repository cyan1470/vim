if [ -z "$1" ]
then
    echo "pls specify the director"
    exit 1
else
    if [ ! -d "$1" ]; then 
        echo "$1 is not a director"
        exit 1
    fi
fi

DEST=$PWD 

cd "$1"

if ! svn info | grep URL > /dev/null
then
exit 1
fi

DIR=`echo $1 | sed -n 's@\([^/]*\)/*$@\1@p' | awk -F "/" '{print $NF}'`_mod_$(date +%Y%m%d)

mkdir -p `svn st | sed -n "s@^M\s*\(.*/.*/\).*@$DEST/$DIR/\1@p" | sort -u`
cp --parents `svn st | sed -n 's@^M\s*\(.*\)@\1@p'` $DEST/$DIR/
